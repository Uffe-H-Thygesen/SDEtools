---
title: "The noisy harmonic oscillator"
author: "Uffe HÃ¸gsbro Thygesen"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Noisy Oscillator}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

We study the noisy harmonic oscillator, given by the two coupled linear SDEs

\[
dX_t = AX_t ~ dt + \sigma ~ dB_t
\]

where $\{B_t : t \geq 0\}$ is two-dimensional standard Brownian motion and 

\[
A = \cdot \left[ \begin{array}{rr}
-\lambda & -\omega \\ 
\omega & -\lambda
\end{array}
\right]
\]

The following code computes and plots the response of the system to an initial condition. Since there are two states, there are four possible responses. Due to symmetry between state 1 and 2, the response from state 1 to state 1 is identical to that from state 2 to state 2, so we only see three distinct curves. 

```{r, fig.show='hold',fig.width=7}
require(Matrix)
require(SDEtools)

w <- 1
l <- 0.1
A <- array(c(-l,w,-w,-l),c(2,2))

tt <- seq(0,30,0.1)
eAt <- sapply(tt,function(t)as.numeric(expm(A*t)))

print(class(eAt))
matplot(tt,t(eAt),type="l",xlab="Time",ylab="Impulse response",ylim=c(-1,1))
legend("topright",lty=1:4,col=1:4,c("1->1","1->2","2->1","2->2"))
```

The following code computes the transition probabilities of the process for a given time step. Then, we use these to recursively sample a trajectory.

```{r, fig.show='hold',fig.width=7}
s<-1
dt <- 0.1
Nt <- 10000
tp <- dLinSDE(A,s*diag(c(1,1)),t=dt)
G <- t(chol(tp$St))
X <- array(0,c(Nt,2))

for(i in 2:Nt) X[i,] <- as.numeric(tp$eAt %*% X[i-1,] + G %*% rnorm(2))
matplot(X[1:1000,],type="l")
```
