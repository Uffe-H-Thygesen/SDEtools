<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Itô Integrals and the Euler-Maruyama method • SDEtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Itô Integrals and the Euler-Maruyama method">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SDEtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SDEtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BrownianMotion.html">Brownian Motion</a>
    </li>
    <li>
      <a href="../articles/CoxIngersollRoss.html">The Cox-Ingersoll-Ross process</a>
    </li>
    <li>
      <a href="../articles/FisheriesManagement.html">Fisheries Management - a Numerical Optimal Control Problem</a>
    </li>
    <li>
      <a href="../articles/HMM-filtering-of-scalar-SDEs.html">HMM filtering of scalar SDEs</a>
    </li>
    <li>
      <a href="../articles/ItoIntegrals.html">Itô Integrals and the Euler-Maruyama method</a>
    </li>
    <li>
      <a href="../articles/ItosFormula.html">Itô's formula</a>
    </li>
    <li>
      <a href="../articles/Killing.html">SDEs with killing</a>
    </li>
    <li>
      <a href="../articles/NoisyOscillator.html">The noisy harmonic oscillator</a>
    </li>
    <li>
      <a href="../articles/NumericalKolmogorov.html">Numerical Analysis of the Kolmogorov Equations</a>
    </li>
    <li>
      <a href="../articles/vanderPol.html">A 2D example: The van der Pol oscillator</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Uffe-H-Thygesen/SDEtools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Itô Integrals and the Euler-Maruyama method</h1>
                        <h4 data-toc-skip class="author">Uffe Høgsbro
Thygesen</h4>
            
            <h4 data-toc-skip class="date">2024-12-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Uffe-H-Thygesen/SDEtools/blob/main/vignettes/ItoIntegrals.Rmd" class="external-link"><code>vignettes/ItoIntegrals.Rmd</code></a></small>
      <div class="hidden name"><code>ItoIntegrals.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="numerical-itô-integration">Numerical Itô integration<a class="anchor" aria-label="anchor" href="#numerical-it%C3%B4-integration"></a>
</h2>
<p>The objective of this vignette is to demonstrate how to perform
(approximate) Itô integration numerically. We do not aim for very high
accuracy; rather, our purpose is to build intuition for the integral,
which is helpful when studying the theory of stochastic differential
equations, in which Itô integratio is an essential element <span class="citation">(Thygesen 2023)</span>.</p>
<p>We consider an <em>integrator</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>B</mi><mi>t</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{B_t\}</annotation></semantics></math>
and an <em>integrand</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>G</mi><mi>t</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{G_t\}</annotation></semantics></math>,
which are both stochastic processes. Think of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>B</mi><mi>t</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{B_t\}</annotation></semantics></math>
as Brownian motion and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>G</mi><mi>t</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{G_t\}</annotation></semantics></math>
as an adapted process, although this is not necessary. We aim to
approximate the Itô integral
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>t</mi></msub><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><msub><mi>G</mi><mi>s</mi></msub><mspace width="0.222em"></mspace><mi>d</mi><msub><mi>B</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">
I_t = \int_0^t G_s ~dB_s
</annotation></semantics></math> numerically, for different values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p>
<p>Given a time discretization
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>=</mo><msub><mi>t</mi><mn>0</mn></msub><mo>&lt;</mo><msub><mi>t</mi><mn>1</mn></msub><mo>&lt;</mo><mi>⋯</mi><mo>&lt;</mo><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">0=t_0 &lt; t_1 &lt; \cdots &lt; t_n</annotation></semantics></math>,
the numerical Itô integral is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>I</mi><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>I</mi><msub><mi>t</mi><mi>i</mi></msub></msub><mo>+</mo><msub><mi>G</mi><msub><mi>t</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>B</mi><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></msub><mo>−</mo><msub><mi>B</mi><msub><mi>t</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> for </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi><mo>−</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
I_0 = 0, \quad I_{t_i+1} = I_{t_{i}} + G_{t_i} (B_{t_{i+1}}- B_{t_i}) \mbox{ for }
i = 0,1,\ldots,n-1.
</annotation></semantics></math> This assumes that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>G</mi><mi>t</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{G_t\}</annotation></semantics></math>
is piecewise constant between the time points
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>.</p>
<p>This approximation is implemented in the function
<strong>itointegral</strong>. For example, we can integrate Brownian
motion w.r.t. itself:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Uffe-H-Thygesen/SDEtools" class="external-link">SDEtools</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: SDEtools</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.01</span><span class="op">)</span></span>
<span>  <span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rBM.html">rBM</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/itointegral.html">itointegral</a></span><span class="op">(</span><span class="va">B</span>,<span class="va">B</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">I</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t</span>,<span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="va">B</span><span class="op">^</span><span class="fl">2</span><span class="op">-</span><span class="va">t</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ItoIntegrals_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>We have included the analytical result
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><msub><mi>B</mi><mi>s</mi></msub><mspace width="0.222em"></mspace><mi>d</mi><msub><mi>B</mi><mi>s</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>B</mi><mi>t</mi><mn>2</mn></msubsup><mo>−</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">\int_0^t B_s ~dB_s = (B_t^2 - t)/2</annotation></semantics></math><span class="citation">(Thygesen 2023)</span>. The agreement is not
perfect; there is a time discretization error.</p>
<p>Note that the numerical Itô integration routine does not need to know
the time grid; only values of the integrator and the integrand at each
time point. The integral is implemented as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">itointegral</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## function (G, B) </span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##     return(c(0, cumsum(G[-length(G)] * diff(B))))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## &lt;bytecode: 0x55e55135de98&gt;</span></span>
<span><span class="co">## &lt;environment: namespace:SDEtools&gt;</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="itô-integrals-and-the-euler-maruyama-method">Itô integrals and the Euler-Maruyama method<a class="anchor" aria-label="anchor" href="#it%C3%B4-integrals-and-the-euler-maruyama-method"></a>
</h2>
<p>Note that the numerical Itô integral is essentially an Euler-Maruyama
solution of the stochastic differential equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>I</mi><mi>t</mi></msub><mo>=</mo><msub><mi>G</mi><mi>t</mi></msub><mspace width="0.222em"></mspace><mi>d</mi><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
dI_t = G_t ~dB_t
</annotation></semantics></math></p>
<p>We see that there is a strong coupling between the Euler-Maruyama
method and numerical Itô integration. To verify this, consider the Itô
stochastic differential equation</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>d</mi><mi>t</mi><mo>+</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>d</mi><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
dX_t = f(X_t) ~dt + g(X_t) ~dB_t
</annotation></semantics></math></p>
<p>with initial condition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X_0=0</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>x</mi><mo>−</mo><msup><mi>x</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">f(x)=x-x^3</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><mn>1</mn><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">g(x) = \sqrt{1+x^2}</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="fl">3</span> </span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">SDEtools</span><span class="fu">::</span><span class="fu"><a href="../reference/euler.html">euler</a></span><span class="op">(</span><span class="va">f</span>,<span class="va">g</span>,<span class="va">t</span>,<span class="fl">0</span>,B<span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">$</span><span class="va">X</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">X</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ItoIntegrals_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>For this solution, we have
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>d</mi><mi>s</mi><mo>+</mo><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mi>d</mi><msub><mi>B</mi><mi>s</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
X_t = \int_0^t f(X_s) ~ds + \int_0^t g(X_s) ~dB_s . 
</annotation></semantics></math></p>
<p>The following code compares the Euler-Maruyama discretization of the
stochastic differential equation with the numerical Itô integral:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">X</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t</span>,<span class="fu"><a href="../reference/itointegral.html">itointegral</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,<span class="va">t</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="../reference/itointegral.html">itointegral</a></span><span class="op">(</span><span class="fu">g</span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,<span class="va">B</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ItoIntegrals_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Note that they seem to fit perfectly. In fact, the error is roughly
machine precision:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">X</span><span class="op">-</span><span class="fu"><a href="../reference/itointegral.html">itointegral</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,<span class="va">t</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="../reference/itointegral.html">itointegral</a></span><span class="op">(</span><span class="fu">g</span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,<span class="va">B</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.220446e-16</span></span></code></pre>
<p>That is, there is no time discretization error because we use the
same principle for time discretization in the Euler-Maruyama method and
in the numerical Itô integral.</p>
</div>
<div class="section level2">
<h2 id="numerical-itô-integration-w-r-t--other-processes">Numerical Itô integration w.r.t. other processes<a class="anchor" aria-label="anchor" href="#numerical-it%C3%B4-integration-w-r-t--other-processes"></a>
</h2>
<p>We can perform numerical Itô integration of any process with respect
to any process, even if the nice properties of the Itô integral (the
martingale property and the Itô isometry) need not hold.</p>
<p>In the following, we demonstrate this by recomputing the Brownian
motion:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>B</mi><mi>t</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.222em"></mspace><mi>d</mi><msub><mi>X</mi><mi>t</mi></msub><mo>−</mo><mfrac><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.222em"></mspace><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">
  dB_t = \frac{1}{g(X_t)} ~ dX_t - \frac{f(X_t)}{g(X_t)} ~dt
</annotation></semantics></math></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/itointegral.html">itointegral</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu">g</span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,<span class="va">X</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="../reference/itointegral.html">itointegral</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">/</span><span class="fu">g</span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,<span class="va">t</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">W</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">B</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ItoIntegrals_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Again, the error is machine precision so there is no time
discretization error:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">B</span><span class="op">-</span><span class="va">W</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.220446e-16</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="numerical-stratonovich-integration">Numerical Stratonovich integration<a class="anchor" aria-label="anchor" href="#numerical-stratonovich-integration"></a>
</h2>
<p>We can repeat the previous with Stratonovich integrals such as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><msub><mi>G</mi><mi>s</mi></msub><mo>∘</mo><mi>d</mi><msub><mi>B</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">
\int_0^t G_s \circ dB_s
</annotation></semantics></math> For example, we can integrate Brownian
motion with respect to itself:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Is</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stochint.html">stochint</a></span><span class="op">(</span><span class="va">B</span>,<span class="va">B</span>,rule<span class="op">=</span><span class="st">"c"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">Is</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t</span>,<span class="fl">0.6</span><span class="op">*</span><span class="va">B</span><span class="op">^</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ItoIntegrals_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Again, we see a reasonable agreement between the numerical and
analytical result, even if it is not perfect, due to the time
discretization.</p>
<p>The difference between the Itô and the Stratonovich integral comes
from the quadratic cross-variation between the integrator and the
integrand. The following code and figure compare the Itô and
Stratonovich integrals
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>I</mi><mi>t</mi><mi>i</mi></msubsup><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><msub><mi>G</mi><mi>s</mi></msub><mspace width="0.222em"></mspace><mi>d</mi><msub><mi>X</mi><mi>s</mi></msub><mo>,</mo><msubsup><mi>I</mi><mi>t</mi><mi>s</mi></msubsup><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><msub><mi>G</mi><mi>s</mi></msub><mo>∘</mo><mi>d</mi><msub><mi>X</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">
  I^i_t = \int_0^t G_s ~dX_s , 
  I^s_t = \int_0^t G_s \circ dX_s  
</annotation></semantics></math> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>s</mi></msub><mo>=</mo><msub><mi>B</mi><mi>s</mi></msub><mo>+</mo><msub><mi>X</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">G_s = B_s + X_s</annotation></semantics></math>,
as well as the relationship between the two
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>I</mi><mi>t</mi><mi>s</mi></msubsup><mo>=</mo><msubsup><mi>I</mi><mi>t</mi><mi>i</mi></msubsup><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false" form="prefix">⟨</mo><mi>G</mi><mo>,</mo><mi>X</mi><msub><mo stretchy="false" form="postfix">⟩</mo><mi>t</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
I^s_t = I^i_t + \frac 12 \langle G,X\rangle_t . 
</annotation></semantics></math></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">+</span><span class="va">B</span></span>
<span><span class="va">Ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/itointegral.html">itointegral</a></span><span class="op">(</span><span class="va">G</span>,<span class="va">X</span><span class="op">)</span></span>
<span><span class="va">Is</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stochint.html">stochint</a></span><span class="op">(</span><span class="va">G</span>,<span class="va">X</span>,rule<span class="op">=</span><span class="st">"c"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Ii</span>,<span class="va">Is</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">Ii</span>,type<span class="op">=</span><span class="st">"l"</span>,ylim<span class="op">=</span><span class="va">ylim</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">Is</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">Ii</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="../reference/CrossVariation.html">CrossVariation</a></span><span class="op">(</span><span class="va">G</span>,<span class="va">X</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ItoIntegrals_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Thygesen2023sde" class="csl-entry">
Thygesen, Uffe Høgsbro. 2023. <em>Stochastic Differential Equations for
Science and Engineering</em>. Taylor &amp; Francis. <a href="http://uffe-h-thygesen.github.io" class="external-link">http://uffe-h-thygesen.github.io</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Uffe Hogsbro Thygesen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
