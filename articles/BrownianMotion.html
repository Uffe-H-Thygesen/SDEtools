<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Brownian Motion • SDEtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Brownian Motion">
<meta property="og:description" content="SDEtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SDEtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SDEtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BrownianMotion.html">Brownian Motion</a>
    </li>
    <li>
      <a href="../articles/FisheriesManagement.html">Fisheries Management - a Numerical Optimal Control Problem</a>
    </li>
    <li>
      <a href="../articles/HMM-filtering-of-scalar-SDEs.html">HMM filtering of scalar SDEs</a>
    </li>
    <li>
      <a href="../articles/ItoIntegrals.html">Itô Integrals and the Euler-Maruyama method</a>
    </li>
    <li>
      <a href="../articles/ItosFormula.html">Itô's formula</a>
    </li>
    <li>
      <a href="../articles/Killing.html">SDEs with killing</a>
    </li>
    <li>
      <a href="../articles/NoisyOscillator.html">The noisy harmonic oscillator</a>
    </li>
    <li>
      <a href="../articles/NumericalKolmogorov.html">Numerical Analysis of the Kolmogorov Equations</a>
    </li>
    <li>
      <a href="../articles/vanderPol.html">A 2D example: The van der Pol oscillator</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Uffe-H-Thygesen/SDEtools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Brownian Motion</h1>
                        <h4 data-toc-skip class="author">Uffe Høgsbro
Thygesen</h4>
            
            <h4 data-toc-skip class="date">2023-06-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Uffe-H-Thygesen/SDEtools/blob/HEAD/vignettes/BrownianMotion.Rmd" class="external-link"><code>vignettes/BrownianMotion.Rmd</code></a></small>
      <div class="hidden name"><code>BrownianMotion.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="simulation-of-brownian-motion">Simulation of Brownian motion<a class="anchor" aria-label="anchor" href="#simulation-of-brownian-motion"></a>
</h2>
<p>Given a set of time points, it is straightforward to simulate
Brownian motion restricted to those time points:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Uffe-H-Thygesen/SDEtools" class="external-link">SDEtools</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: SDEtools</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rBM.html">rBM</a></span><span class="op">(</span><span class="va">tv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tv</span>,<span class="va">B</span>,type<span class="op">=</span><span class="st">"b"</span>,xlab<span class="op">=</span><span class="st">"t"</span>,ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">B</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="BrownianMotion_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>The simulation routine starts by finding the time increments. Then
random Gaussian variables are simulated for each increment, using that
the increments of Brownian motion are independent and have a variance
which scales with time. Finally the increments are added to obtain the
Brownian motion itself.</p>
<p>This is coded in the function rBM:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rBM</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## function (times, sigma = 1, B0 = 0, u = 0) </span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##     dt &lt;- c(times[1], diff(times))</span></span>
<span><span class="co">##     dB &lt;- rnorm(length(times), mean = u * dt, sd = sigma * sqrt(dt))</span></span>
<span><span class="co">##     B &lt;- B0 + cumsum(dB)</span></span>
<span><span class="co">##     return(B)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## &lt;bytecode: 0x5564ca613e20&gt;</span></span>
<span><span class="co">## &lt;environment: namespace:SDEtools&gt;</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="verifying-the-statistics-of-brownian-motion">Verifying the statistics of Brownian motion<a class="anchor" aria-label="anchor" href="#verifying-the-statistics-of-brownian-motion"></a>
</h2>
<p>Let us generate a large number of sample paths for the same time
discretization and check the statistics.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">n</span>,<span class="fu"><a href="../reference/rBM.html">rBM</a></span><span class="op">(</span><span class="va">tv</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1]     [,2]     [,3]     [,4]</span></span>
<span><span class="co">## [1,]    0 0.000000 0.000000 0.000000</span></span>
<span><span class="co">## [2,]    0 1.027051 1.042329 1.038597</span></span>
<span><span class="co">## [3,]    0 1.042329 2.159026 2.130307</span></span>
<span><span class="co">## [4,]    0 1.038597 2.130307 4.027781</span></span></code></pre>
<p>Compare this with the analytical result:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">tv</span>,<span class="va">tv</span>,<span class="fu"><a href="https://rdrr.io/r/base/Vectorize.html" class="external-link">Vectorize</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">## [1,]    0    0    0    0</span></span>
<span><span class="co">## [2,]    0    1    1    1</span></span>
<span><span class="co">## [3,]    0    1    2    2</span></span>
<span><span class="co">## [4,]    0    1    2    4</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="scaling-properties-of-brownian-motion">Scaling properties of Brownian motion<a class="anchor" aria-label="anchor" href="#scaling-properties-of-brownian-motion"></a>
</h2>
<p>Brownian motion scales with the square root of time:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1e-5</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fu"><a href="../reference/rBM.html">rBM</a></span><span class="op">(</span><span class="va">tv</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">tv</span>,<span class="va">B</span>,type<span class="op">=</span><span class="st">"l"</span>,lty<span class="op">=</span><span class="fl">1</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tv</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">tv</span><span class="op">)</span>,lty<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tv</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">tv</span><span class="op">)</span>,lty<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">tv</span>,<span class="va">B</span>,type<span class="op">=</span><span class="st">"l"</span>,lty<span class="op">=</span><span class="fl">1</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>,<span class="fl">0.2</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tv</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">tv</span><span class="op">)</span>,lty<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tv</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">tv</span><span class="op">)</span>,lty<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BrownianMotion_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="the-brownian-bridge">The Brownian bridge<a class="anchor" aria-label="anchor" href="#the-brownian-bridge"></a>
</h2>
<p>Given two end points, we can simulate a Brownian bridge that connects
them. That is, we simulate a Brownain motion conditionally on the end
points.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">tv</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">:</span><span class="fl">20</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span>
<span>  <span class="va">B0T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span>  <span class="va">BB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">n</span>,<span class="fu"><a href="../reference/rBrownianBridge.html">rBrownianBridge</a></span><span class="op">(</span><span class="va">tv</span>,sigma<span class="op">=</span><span class="va">sigma</span>,B0T<span class="op">=</span><span class="va">B0T</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">tv</span>,<span class="va">BB</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="BrownianMotion_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>We can verify the statistics by plotting the mean and variance of the
bridge:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tv</span>,<span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">BB</span>,<span class="fl">1</span>,<span class="va">mean</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">"t"</span>,ylab<span class="op">=</span><span class="st">"mean"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">tv</span><span class="op">)</span>,<span class="va">B0T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tv</span>,<span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">BB</span>,<span class="fl">1</span>,<span class="va">var</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">"t"</span>,ylab<span class="op">=</span><span class="st">"var"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tv</span>,<span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">tv</span><span class="op">-</span><span class="va">tv</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">tv</span><span class="op">-</span><span class="va">tv</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">tv</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="BrownianMotion_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="simulation-of-the-maximum-of-brownian-motion">Simulation of the maximum of Brownian motion<a class="anchor" aria-label="anchor" href="#simulation-of-the-maximum-of-brownian-motion"></a>
</h2>
<p>We study the maximum of the Brownian motion, as well as its maximum
absolute value.</p>
<p>For the maximum we have the analytical result:</p>
<p><span class="math display">\[
\mathbf{P}(S_t \geq x) = 2\mathbf{P}( B_t \geq x)
\]</span></p>
<p>where</p>
<p><span class="math display">\[
S_t= \max\{ B_s : 0\leq s \leq t \}
\]</span></p>
<p>For the max-abs, we have the bound</p>
<p><span class="math display">\[
\mathbf{P}(\bar S_t \geq x) \leq 4\mathbf{P}( B_t \geq x)
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\bar S_t= \max\{ |B_s| : 0\leq s \leq t \}
\]</span></p>
<p>The following code simulates a number of sample paths of Brownian
motion <span class="math inline">\(B_t\)</span> over a time interval
<span class="math inline">\(t=0,\ldots,Nt\)</span>. For each sample path
we compute the maximum as well as the maximum absolute value. We plot
the the empirical statistics of the maximum, and the max-abs, against
analytical approximations. The statistics are the histogram, which
should be compared with the probability density function (pdf), and the
complementary cumulated distribution function (ccdf), also referred to
as the survival function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Uffe-H-Thygesen/SDEtools" class="external-link">SDEtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">hist.maxBM.compare.analytical.Monte.Carlo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Nt</span>,<span class="va">Np</span><span class="op">)</span></span>
<span><span class="op">{</span> </span>
<span>  <span class="co">## Simulate Np trajectories of BM on {0,1,...,Nt}</span></span>
<span>  <span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rvBM.html">rvBM</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">Nt</span>,<span class="va">Np</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## Compute max(B) and max(abs(B))</span></span>
<span>  <span class="va">maxB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">B</span>,<span class="fl">2</span>,<span class="va">max</span><span class="op">)</span></span>
<span>  <span class="va">maxabsB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">B</span>,<span class="fl">2</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">## Histogram of max(B) vs theoretical p.d.f.  </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">maxB</span>,freq<span class="op">=</span><span class="cn">FALSE</span>,xlab<span class="op">=</span><span class="st">"x"</span>,ylab<span class="op">=</span><span class="st">"P.d.f."</span>,</span>
<span>       main<span class="op">=</span><span class="st">"Pdf of max(BM)"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Nt</span><span class="op">)</span><span class="op">)</span>,from<span class="op">=</span><span class="fl">0</span>,to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">maxB</span><span class="op">)</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">## Empirical vs. theoretical survival function of max(B)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">maxB</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,length<span class="op">=</span><span class="va">Np</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"s"</span>,xlab<span class="op">=</span><span class="st">"x"</span>,ylab<span class="op">=</span><span class="st">"Ccdf, P(X&gt;x)"</span>,</span>
<span>       main<span class="op">=</span><span class="st">"Ccdf of max(BM)"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fl">2</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">x</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Nt</span><span class="op">)</span><span class="op">)</span>,from<span class="op">=</span><span class="fl">0</span>,to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">maxB</span><span class="op">)</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">## Empirical vs. approximate theoretical survival function of max(abs(B))</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">maxabsB</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,length<span class="op">=</span><span class="va">Np</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"s"</span>,xlab<span class="op">=</span><span class="st">"x"</span>,ylab<span class="op">=</span><span class="st">"Ccdf, P(X&gt;x)"</span>,</span>
<span>    main<span class="op">=</span><span class="st">"Ccdf of max(abs(BM)"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fl">4</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">x</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Nt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,from<span class="op">=</span><span class="fl">0</span>,to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">maxB</span><span class="op">)</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We first try the comparison using 1000 sample paths (which is
sufficient) and over 1000 time steps:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist.maxBM.compare.analytical.Monte.Carlo</span><span class="op">(</span>Nt<span class="op">=</span><span class="fl">1000</span>,Np<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="BrownianMotion_files/figure-html/unnamed-chunk-9-1.png" width="700"><img src="BrownianMotion_files/figure-html/unnamed-chunk-9-2.png" width="700"><img src="BrownianMotion_files/figure-html/unnamed-chunk-9-3.png" width="700"></p>
<p>We see that there is excellent agreement between the maximum and the
theoretical prediction. As for the max-abs, we see that there is good
agreement in the tail, i.e. for high values of <span class="math inline">\(x\)</span>, but poor agreement for low values of
<span class="math inline">\(x\)</span>. The reason for this disagreement
is the bound on <span class="math inline">\(\mathbf{P}(\bar S_t \geq
x)\)</span> is obtained by ignoring the probability that the maximum
exceeds <span class="math inline">\(x\)</span> and at the same time the
minimum exceeds <span class="math inline">\(-x\)</span>. When <span class="math inline">\(x\)</span> is small, this error becomes large.</p>
<p>The next graph repeats this for a small number of time steps, <span class="math inline">\(Nt=10\)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist.maxBM.compare.analytical.Monte.Carlo</span><span class="op">(</span>Nt<span class="op">=</span><span class="fl">10</span>,Np<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="BrownianMotion_files/figure-html/unnamed-chunk-10-1.png" width="700"><img src="BrownianMotion_files/figure-html/unnamed-chunk-10-2.png" width="700"><img src="BrownianMotion_files/figure-html/unnamed-chunk-10-3.png" width="700"></p>
<p>We see that there is poor agreement everywhere now. The reason is the
difference between the continuous-time maximum</p>
<p><span class="math display">\[
\max\{ B_s : 0 \leq s \leq t\}
\]</span></p>
<p>and the maximum of the sampled process</p>
<p><span class="math display">\[
\max\{ B_s : s=0,1,\ldots,t\}
\]</span></p>
<p>When <span class="math inline">\(t\)</span> is small, this difference
becomes more important.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Uffe Hogsbro Thygesen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
